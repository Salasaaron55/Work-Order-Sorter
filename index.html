<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Work Order Viewer</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- CSV parser -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <!-- XLSX parser (SheetJS) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="logo">WO</div>
        <div>
          <div class="title">Work Order Viewer</div>
          <div class="subtitle">
            Upload CSV/XLSX → filter → drag columns → see counts
          </div>
        </div>
      </div>

      <div class="upload">
        <label class="filebtn">
          <input id="fileInput" type="file" accept=".csv,.xlsx,.xls" />
          <span>Upload CSV/XLSX</span>
        </label>
        <button id="resetBtn" class="ghost">Reset</button>
      </div>
    </header>

    <main class="layout">
      <section class="panel filters">
        <div class="panelHeader">
          <h2>Filters</h2>
          <div class="hint">Filters apply to the table and counts.</div>
        </div>

        <div class="grid">
          <div class="field">
            <label>Keyword (search Description/Equipment/etc)</label>
            <input
              id="keyword"
              type="text"
              placeholder="e.g., KAESER, dock, pump, leak..."
            />
          </div>

          <div class="field">
            <label>Date column for counts</label>
            <select id="countDateColumn">
              <option value="Sched. Start Date" selected>
                Scheduled start date
              </option>
              <option value="Original PM Due Date">Original PM due date</option>
              <option value="Sched. End Date">Scheduled end date</option>
            </select>
          </div>

          <div class="field">
            <label>Date from</label>
            <input id="dateFrom" type="date" />
          </div>

          <div class="field">
            <label>Date to</label>
            <input id="dateTo" type="date" />
          </div>

          <div class="field">
            <label>Status</label>
            <select id="status">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Type</label>
            <select id="type">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Department</label>
            <select id="department">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Assigned to (multi-select)</label>
            <select id="assignedTo" multiple size="8"></select>
            <div class="minirow">
              <button id="selectAllPeople" class="tiny">Select all</button>
              <button id="clearPeople" class="tiny ghost">Clear</button>
            </div>
          </div>
        </div>

        <div class="panelFooter">
          <div class="stats" id="stats">
            <div class="stat">
              <div class="statLabel">Rows</div>
              <div class="statValue" id="statRows">—</div>
            </div>
            <div class="stat">
              <div class="statLabel">Employees</div>
              <div class="statValue" id="statPeople">—</div>
            </div>
            <div class="stat">
              <div class="statLabel">Date span</div>
              <div class="statValue" id="statSpan">—</div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel counts">
        <div class="panelHeader">
          <h2>Counts (Assigned To × Date)</h2>
          <div class="hint">Date format: MM/DD/YYYY</div>
        </div>

        <div class="tableWrap">
          <table id="countsTable" class="table compact">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="panel data">
        <div class="panelHeader">
          <h2>Work Orders</h2>
          <div class="hint">
            Drag column headers to rearrange. Saved automatically.
          </div>
        </div>

        <div class="tableWrap big">
          <table id="dataTable" class="table">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div>
        Tip: If your CSV has weird headers, this app matches columns loosely
        (case/punctuation-insensitive).
      </div>
    </footer>

    <script src="app.js"></script>
  </body>
</html>
