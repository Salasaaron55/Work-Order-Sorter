<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Work Order Viewer</title>
    <link rel="stylesheet" href="style.css" />

    <!-- For XLSX support (optional, but included since you provided an .xlsx sample) -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/xlsx@0.20.2/dist/xlsx.full.min.js"
    ></script>
    <script defer src="app.js"></script>
  </head>

  <body>
    <header class="topbar">
      <div class="topbar-left">
        <div class="brand">
          <div class="brand-title">Work Order Viewer</div>
          <div class="brand-subtitle">
            Upload CSV/XLSX â†’ filter, sort, drag columns, and auto-count per
            employee/day
          </div>
        </div>
      </div>

      <div class="topbar-right">
        <label class="file-btn">
          <input id="fileInput" type="file" accept=".csv,.xlsx,.xls" />
          <span>Upload CSV/XLSX</span>
        </label>

        <button
          id="resetLayoutBtn"
          class="btn btn-ghost"
          title="Reset saved column order/widths"
        >
          Reset layout
        </button>
      </div>
    </header>

    <main class="layout">
      <section class="panel controls">
        <div class="controls-row">
          <div class="field">
            <label>Keyword search</label>
            <input
              id="keywordInput"
              type="text"
              placeholder="Search Work Order, Description, Equipment, Dept, Type, Status..."
            />
          </div>

          <div class="field">
            <label>Assigned To</label>
            <select id="assignedSelect">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Status</label>
            <select id="statusSelect">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Type</label>
            <select id="typeSelect">
              <option value="">All</option>
            </select>
          </div>

          <div class="field">
            <label>Department</label>
            <select id="deptSelect">
              <option value="">All</option>
            </select>
          </div>
        </div>

        <div class="controls-row">
          <div class="field">
            <label>Scheduled start date (from)</label>
            <input id="dateFrom" type="date" />
          </div>

          <div class="field">
            <label>Scheduled start date (to)</label>
            <input id="dateTo" type="date" />
          </div>

          <div class="field field-inline">
            <label class="checkbox">
              <input id="hideUnassigned" type="checkbox" />
              <span>Hide unassigned</span>
            </label>
          </div>

          <div class="field field-inline">
            <label class="checkbox">
              <input id="useCurrentFiltersForCounts" type="checkbox" checked />
              <span>Counts follow current filters</span>
            </label>
          </div>

          <div class="spacer"></div>

          <div class="results-meta">
            <div><strong id="rowCount">0</strong> rows shown</div>
            <div class="hint">
              Tip: drag column headers to rearrange (saved automatically).
            </div>
          </div>
        </div>
      </section>

      <section class="panel table-wrap">
        <div class="table-scroll">
          <table id="dataTable">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="panel summary">
        <div class="summary-header">
          <h2>Work Orders per Employee per Day</h2>
          <div class="summary-actions">
            <button id="exportSummaryBtn" class="btn btn-ghost">
              Export summary CSV
            </button>
          </div>
        </div>
        <div class="summary-scroll">
          <table id="summaryTable">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="summary-note">
          Counts are grouped by <strong>Sched. Start Date</strong> (day) +
          <strong>Assigned To</strong> (employee).
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footer-left">
        <span class="dot"></span>
        <span id="fileStatus">No file loaded.</span>
      </div>
      <div class="footer-right">
        Date format shown as <strong>MM/DD/YYYY</strong>.
      </div>
    </footer>
  </body>
</html>
